# 1.29

## 练习 1.29： 辛普森规则是另一种比上面所用规则更精确的数值积分方法。采用辛普森规则，函数f在范围a和b之间的定积分的近似值是：
$$
\frac{h}{3}[y_0+4y_1+2y_2+4y_3+2y_4+...+2y_{n-2}+4y_{n-1}+y_n]
$$

## 其中 h=(b-a)/n，n是某个偶数，而 $$y_k=f(a+kh)$$ （增大n能提高近似值的精度）。请定义一个具有参数f、a、b和n，采用辛普森规则计算并返回积分值的过程。用你的函数求出cube在0和1之间的积分（用n=100和n=1000），并将得到的值与上面用 integral 过程所得到的结果比较。


```eval-scheme
(define (cube x) (* x x x))
(cube 3)

(define (sum term a next b)
    (if (> a b)
        0
        (+ (term a) (sum term (next a) next b))))

(define (integral f a b dx)
    (define (add-dx x) (+ x dx))
    (* (sum f (+ a (/ dx 2.0)) add-dx b) dx)
)

(integral cube 0 1 0.001)

```

```eval-scheme
(define (cube x) (* x x x))
(define (sum-product term a next b next-product)
    (if (> a b)
        0
        (+ (* (next-product a) (term a)) (sum-product term (next a) next b next-product))))

(define (integral2 f a b n)
    (define (h a b n) (/ (- b a) n))
    (define (add-h x) (+ x (h a b n)))
    (define (next x)
        (cond ((= x a) 1)
              ((= x b) 1)
              ((even? (/ (* n (- x a)) (- b a))) 2)
              (else 4))
    )
    (* (/ (h a b n) 3) (sum-product f a add-h b next))
)

(integral2 cube 0 1 100)
```